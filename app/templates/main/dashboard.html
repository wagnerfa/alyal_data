{% extends "base.html" %}

{% block title %}Dashboard - Alyal Analytics{% endblock %}

{% block content %}
<div class="dashboard-container">
    <nav class="navbar">
        <div class="navbar-brand">
            <h2>Alyal Analytics</h2>
        </div>
        <div class="navbar-menu">
            {% if current_user.can_view_all_companies() %}
            <a href="{{ url_for('admin.companies_list') }}" class="nav-link">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                </svg>
                Empresas
            </a>
            {% endif %}
            <div class="user-info">
                <div class="user-avatar">{{ current_user.username[0].upper() }}</div>
                <div class="user-details">
                    <span class="user-name">{{ current_user.username }}</span>
                    <span class="user-role">{{ current_user.role|title }}</span>
                </div>
            </div>
            <a href="{{ url_for('auth.logout') }}" class="btn-logout">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                    <polyline points="16 17 21 12 16 7"></polyline>
                    <line x1="21" y1="12" x2="9" y2="12"></line>
                </svg>
                Sair
            </a>
        </div>
    </nav>

    <div class="dashboard-content">
        <div class="welcome-section">
            <h1 class="animated-title">Ol√°, {{ current_user.username }}! üëã</h1>
            <p class="subtitle">
                {% if current_user.is_gestor() %}
                Gerencie empresas e visualize todos os dados do sistema
                {% elif current_user.is_analista() %}
                Visualize e analise dados de todas as empresas
                {% else %}
                Acompanhe os analytics da sua empresa
                {% endif %}
            </p>
        </div>
        
        <div class="cards-grid">
            {% if current_user.can_view_all_companies() %}
            <div class="card card-1" onclick="window.location.href='{{ url_for('admin.companies_list') }}'">
                <div class="card-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                        <polyline points="9 22 9 12 15 12 15 22"></polyline>
                    </svg>
                </div>
                <h3>Empresas</h3>
                <p>Gerencie todas as empresas cadastradas</p>
                <div class="card-stats">
                    <span class="stat-number">{{ current_user.get_accessible_companies()|length }}</span>
                    <span class="stat-label">empresas</span>
                </div>
            </div>
            {% else %}
            <div class="card card-1">
                <div class="card-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                        <polyline points="9 22 9 12 15 12 15 22"></polyline>
                    </svg>
                </div>
                <h3>Minha Empresa</h3>
                <p>{{ current_user.company.name if current_user.company else 'Sem empresa vinculada' }}</p>
                <div class="card-stats">
                    {% if current_user.company %}
                    <span class="badge badge-success">Ativo</span>
                    {% else %}
                    <span class="badge badge-warning">N√£o vinculado</span>
                    {% endif %}
                </div>
            </div>
            {% endif %}

            <div class="card card-2">
                <div class="card-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                        <circle cx="12" cy="7" r="4"></circle>
                    </svg>
                </div>
                <h3>Perfil</h3>
                <p>{{ current_user.email }}</p>
                <div class="card-stats">
                    <span class="badge badge-{{ 'primary' if current_user.is_gestor() else 'info' if current_user.is_analista() else 'secondary' }}">
                        {{ current_user.role|title }}
                    </span>
                </div>
            </div>

            <div class="card card-3">
                <div class="card-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                        <polyline points="7 10 12 15 17 10"></polyline>
                        <line x1="12" y1="15" x2="12" y2="3"></line>
                    </svg>
                </div>
                <h3>Relat√≥rios</h3>
                <p>Uploads e an√°lises de dados</p>
                <div class="card-stats">
                    <span>Em breve...</span>
                </div>
            </div>

            <div class="card card-4">
                <div class="card-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="12" y1="1" x2="12" y2="23"></line>
                        <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
                    </svg>
                </div>
                <h3>Analytics</h3>
                <p>Dashboards e insights</p>
                <div class="card-stats">
                    <span>Em breve...</span>
                </div>
            </div>
        </div>

        <div class="info-section">
            <div class="info-card">
                <h3>Informa√ß√µes da Conta</h3>
                <div class="info-list">
                    <div class="info-item">
                        <span class="info-label">Nome de Usu√°rio:</span>
                        <span class="info-value">{{ current_user.username }}</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">E-mail:</span>
                        <span class="info-value">{{ current_user.email }}</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Tipo de Acesso:</span>
                        <span class="info-value">{{ current_user.role|title }}</span>
                    </div>
                    {% if current_user.company %}
                    <div class="info-item">
                        <span class="info-label">Empresa:</span>
                        <span class="info-value">{{ current_user.company.name }}</span>
                    </div>
                    {% endif %}
                    <div class="info-item">
                        <span class="info-label">Membro desde:</span>
                        <span class="info-value">{{ current_user.created_at.strftime('%d/%m/%Y √†s %H:%M') }}</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
{% endblock %}